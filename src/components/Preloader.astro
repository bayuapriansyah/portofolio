---

---

<div
  id="preloader"
  class="fixed inset-0 z-[100] flex items-center justify-center bg-slate-950 overflow-hidden pointer-events-auto"
>
  <!-- Stars Background -->
  <div
    id="stars-container"
    class="absolute inset-0 pointer-events-none opacity-30"
  >
  </div>

  <div class="relative flex flex-col items-center">
    <!-- Cloud/Speed Lines -->
    <div
      id="lines-container"
      class="absolute inset-0 pointer-events-none overflow-hidden"
    >
    </div>

    <!-- Loading Percentage -->
    <div class="mt-8 flex flex-col items-center gap-2">
      <div id="count" class="text-6xl font-black tracking-tighter text-white">
        0
      </div>
      <div class="w-48 h-1 bg-white/10 rounded-full overflow-hidden mt-4">
        <div
          id="progress-bar"
          class="w-0 h-full bg-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.5)]"
        >
        </div>
      </div>
      <span
        class="text-[10px] uppercase tracking-[0.4em] font-bold text-slate-500 mt-4"
        >System Initializing</span
      >
    </div>
  </div>
</div>

<script>
  import { gsap } from "gsap";

  const initPreloader = () => {
    // Session check
    if (sessionStorage.getItem("preloaderShown")) {
      const preloader = document.getElementById("preloader");
      if (preloader) preloader.style.display = "none";
      return;
    }

    const starContainer = document.getElementById("stars-container");
    if (starContainer) {
      for (let i = 0; i < 50; i++) {
        const star = document.createElement("div");
        star.className = "absolute bg-white rounded-full";
        const size = Math.random() * 2;
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.left = `${Math.random() * 100}%`;
        star.style.top = `${Math.random() * 100}%`;
        star.style.opacity = (Math.random() * 0.5 + 0.5).toString();
        starContainer.appendChild(star);
      }
    }

    const lineContainer = document.getElementById("lines-container");
    if (lineContainer) {
      for (let i = 0; i < 20; i++) {
        const line = document.createElement("div");
        line.className = "absolute bg-white/20 rounded-full line-streak";
        line.style.width = "1px";
        line.style.height = `${Math.random() * 150 + 50}px`;
        line.style.left = `${Math.random() * 100}%`;
        line.style.top = `-200px`;
        lineContainer.appendChild(line);
      }
    }

    const tl = gsap.timeline({
      onComplete: () => {
        sessionStorage.setItem("preloaderShown", "true");
        const preloader = document.getElementById("preloader");
        if (preloader) preloader.style.display = "none";
      },
    });

    gsap.set(".line-streak", { opacity: 0 });

    gsap.to(".line-streak", {
      opacity: 0.2,
      y: window.innerHeight + 300,
      duration: 1.2,
      stagger: { amount: 1.2, repeat: -1 },
      ease: "none",
    });

    tl.to("#count", {
      innerText: 100,
      duration: 2.2,
      snap: { innerText: 1 },
      ease: "power2.inOut",
      onUpdate: function () {
        const target = this.targets()[0];
        const val = Math.floor(Number(target.innerText));
        const bar = document.getElementById("progress-bar");
        if (bar) bar.style.width = `${val}%`;
      },
    }).to(
      "#preloader",
      {
        y: "-100%",
        duration: 1.2,
        ease: "expo.inOut",
      },
      "+=0.2",
    );

    tl.to(
      "#stars-container div",
      {
        y: window.innerHeight,
        duration: 1,
        stagger: { amount: 0.4, from: "random" },
        ease: "power2.in",
      },
      "-=1.2",
    );
  };

  window.addEventListener("load", initPreloader);
</script>

<style>
  #preloader {
    /* Prevent interaction with content below while loading */
    touch-action: none;
    user-select: none;
  }
</style>
